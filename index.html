<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Learn CSS Animations</title>
  <link href='https://fonts.googleapis.com/css?family=Titillium+Web:400,700' rel='stylesheet'>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <header><h1>CSS Flight Survivor</h1></header>
  <div class="container">
    <div class="top">
      <section class="columns active" data-level="level-1">

        <div class="left">
          <h2>Emergency 1: Too Slow!</h2>
          <p>It seems the plane is flying too slowly. <strong>Move the plane across the screen in exactly 3 seconds.</strong> The animation you'll call is <code>moveRight</code>. Your animation should be done using the shorthand syntax. Example: <code>animation: animationName 1.5s forwards;</code>.</p>
        </div>

        <div class="right">
          <div id="editor">
            <div id="css">
              <pre id="before">.plane {
  animation: <input id="code" autofocus /></pre>
              <pre id="after">}</pre>
            </div>
            <button id="try-it">Try it</button>
          </div>
        </div>

      </section>

      <section class="columns" data-level="level-2">
        <h2>Emergency 2: Avoid the Birds</h2>
        <p>Large birds pose a serious threat all lives aboard this phony plane. Do something!</p>
      </section>
    </div>
    <div class="bottom">
      <div class="clouds">
        <div class="x1">
          <div class="cloud"></div>
        </div>

        <div class="x2">
          <div class="cloud"></div>
        </div>

        <div class="x3">
          <div class="cloud"></div>
        </div>

        <div class="x4">
          <div class="cloud"></div>
        </div>

        <div class="x5">
          <div class="cloud"></div>
        </div>
      </div>
      <div class="plane"></div>
      <div class="mountain"></div>
      <div class="bird"></div>
    </div>
  </div>

<!-- <script>document.write('<script src="http://' + (location.host || 'localhost').split(':')[0] + ':35729/livereload.js?snipver=1"></' + 'script>')</script> -->
<script>
  window.onload = init;

  var answers = {
        step1: {
          answer: "moveRight 3s forwards;",
          apply_class: "step-one-answer"
        }
      },
      plane   = document.getElementsByClassName("plane")[0],
      try_it  = document.getElementById("try-it"),
      code    = document.getElementById("code"),
      body    = document.body;

  function tryItHandler() {
    var val    = code.value,
        answer = answers["step1"]["answer"];

    if (val === answer) {
      plane.classList.add(answers["step1"]["apply_class"]);
    } else {
      body.classList.add("wrong");
    }
  }

  function codeHandler(e) {
    if (e.keyCode === 13) {
      tryItHandler();
    }
  }

  function cleanBody() {
    body.classList.remove("wrong");
  }

  function bindings() {
    try_it.addEventListener("click", tryItHandler);
    try_it.addEventListener("animationend", cleanBody);
    code.addEventListener("keyup", codeHandler);
    window.addEventListener("hashchange", hashchangeHandler);
  }

  function hashchangeHandler() {
    var hash  = location.hash,
        curr_active, next_active;

    if (!hash.length) return;

    curr_active = document.querySelector("section.active"),
    next_active = document.querySelector("[data-level=" + hash.slice(1) + "]");

    if (next_active !== null) {
      curr_active.classList.remove("active");
      next_active.classList.add("active");
    }
  }

  function movePlaneOnScreen() {
    body.classList.add("move-on-screen");
  }

  function setLevel(level, e) {
    history.pushState({}, null, '#level-' + level);
    e.preventDefault();
  }

  function init(e) {
    bindings();
    movePlaneOnScreen();
    setLevel(1, e);
  }
</script>
</body>
</html>